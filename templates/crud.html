{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}Django{% endblock %}

{% block content %}
<div class="container">
    
    <div class="row">
        <div class="column">
            <a href="{% url 'form'  %}"><button type="button" class="btn  btn-light btn-lg btn-block">ADD NEW</button></a>
        </div>
       
        <div class="col-md-12">
            <h3>USERS</h3>
            <table id="userTable" class="table table-striped">
                <tr>
                    <th>Name</th>
                    <th>Job Tile</th>
                    <th colspan="3">Logged in</th>
                </tr>
                {% for user in users %}
                <tr id="user-{{user.id}}">
                    <td><a href="{% url 'detail' user.id %}"  class="userName userData" name="name">{{user.title}}.{{user.first}} {{user.last}}</a></td>
                    <td class="userAddress userData" name="address">{{user.job_title}}</td>
                    <td class="userAge userData" name="age">{{user.loggedIn}}</td>
                    
                    <td align="center">
                        
                        <a href="{% url 'update' user.id%}"><button class="btn btn-success form-control">EDIT</button></a>
                    </td>
                    <td align="center">
                        <button class="btn btn-danger form-control" onClick="deleteUser({{user.id}})">DELETE</button>
                       
                    </td>
                    
                    
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
<!-- Modal -->

{% endblock %}

{% block javascript %}

<script>
  

    // Delete Django Ajax Call
    function deleteUser(id) {
        var action = confirm("Are you sure you want to delete this user?");
        if (action != false) {
            $.ajax({
                url: '{% url "delete" %}',
                data: {
                    'id': id,
                },
                dataType: 'json',
                success: function (data) {
                    if (data.deleted) {
                        $("#userTable #user-" + id).remove();
                    }
                }
            });
        }
    }



</script>


{% endblock javascript %}